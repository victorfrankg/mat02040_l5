---
title: "Estatística Espacial - MAT02040 - Lista 6"
author: | 
    | IME - Universidade Federal do Rio Grande do Sul
    | Prof.ª Márcia Barbian
    | Alunos: Alisson Neimaier, Enzo Bertoldi, Gabriel Fagundes, Victor Frank
date: "20/05/2021"
output:
  html_document:
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pkgs <- c("tidyverse", "leaflet", "sf", "spatstat", "splancs", "sp", "rgdal", "spdep", "spatstat", "maptools", "RColorBrewer", "readxl", "dplyr", "kableExtra", "scales", "smacpod", "rvest", "plotly", "INLA","stringr","readr", "devtools")
lapply(pkgs, require, character.only = TRUE)
```

### Questão 1
Os dados a serem analisados são referentes à medidas de elevação de terrenos na França.

a) Faça um mapa com a localização dessas observações.

b) Faça uma análise exploratória dos dados, avalie a distribuição da variável elevação, faça uma comparação entre esses valores e as coordenadas geográficas das observações.

c) Faça um plot da diferença entre os valores observados, dado a distância entre os pares de observações (*variogram cloud*), avalie se essa nuvem de pontos indica a presença de *outliers*.

d) Faça a estimação do semivariograma, considere os modelos exponencial, e matern. Qual o valor da Sill, do Range e do efeito pepita para o modelo matern. Interprete esses parâmetros. (Dica: função `print.eyefit`)

e) Avalie a presença de anisometropia.

### Questão 2
O banco de dados da questão 2 são referentes à precipitação no estado da Califórnia, além da quantidade de chuva o banco possui a covariável altitude. Escolha um dos meses para o exercício.

```{r Q2 Setup, echo = FALSE, message = FALSE, warning = FALSE}

if (!require("rspatial")) devtools::install_github('rspatial/rspatial')

library(rspatial)
d <- sp_data('precipitation')
```

a) Faça um mapa com a localização dessas observações e uma análise exploratória dos dados.

b) Estime o semivariograma, para as funções de covariância exponencial, esférica e gaussiana. Interprete os parâmetros estimados de sill, range e efeito pepita da função de covariância exponencial.

c) Calcule o os parâmetros da função de covariância exponencial por meio da função `likfit` do pacote geoR. Compare com os resultados da letra *b*.

d) Faça a predição da superfície de chuva, não considere nenhuma covariável nessa estimativa. Plote o mapa de calor das estimativas e de suas variâncias. (Dica: função `polygrid`)

e) Refaça a letra *d*, mas utilize a covariável altitude na krigagem.

f) De uma olhada na função `image.kriging {geoR}`.
